(this.webpackJsonprost=this.webpackJsonprost||[]).push([[0],{76:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(11),o=n.n(c),s=(n(76),n(17)),i=n(117),u=n(9),l=n(38),j=n(49),d=n(113),h=n(118),b=n(119),f=n(4);var O=Object(u.h)((function(e){var t=e.handleLogin,n=e.history,r=Object(j.b)(),a=r.handleSubmit,c=r.formState.errors,o=r.control;return Object(f.jsxs)("form",{onSubmit:a((function(e){return function(e,t){return fetch("https://agile-garden-50413.herokuapp.com/api/token/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e.auth_token?(localStorage.setItem("jwt",e.auth_token),e):void 0})).catch((function(e){return console.log(e)}))}(e.username,e.password).then((function(e){e.auth_token&&(t(),n.push("/"))})).catch((function(e){return console.log(e)}))})),noValidate:!0,children:[Object(f.jsx)(d.a,{variant:"h4",children:"\u0412\u043e\u0439\u0442\u0438"}),Object(f.jsx)(j.a,{name:"username",control:o,defaultValue:"",rules:{required:{value:!0,message:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"},minLength:{value:2,message:"\u041c\u0435\u043d\u044c\u0448\u0435 2 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"},maxLength:{value:15,message:"\u0411\u043e\u043b\u044c\u0448\u0435 15 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}},render:function(e){var t=e.field;return Object(f.jsx)(h.a,Object(l.a)({type:"text",label:"Username",variant:"outlined",required:!0,fullWidth:!0,margin:"normal"},t))}}),c.username&&Object(f.jsx)(d.a,{variant:"subtitle2",color:"error",paragraph:!0,children:c.username.message}),Object(f.jsx)(j.a,{name:"password",control:o,defaultValue:"",rules:{required:{value:!0,message:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"},minLength:{value:2,message:"\u041c\u0435\u043d\u044c\u0448\u0435 2 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"},maxLength:{value:15,message:"\u0411\u043e\u043b\u044c\u0448\u0435 15 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}},render:function(e){var t=e.field;return Object(f.jsx)(h.a,Object(l.a)({type:"password",label:"Password",variant:"outlined",required:!0,fullWidth:!0,margin:"normal"},t))}}),c.password&&Object(f.jsx)(d.a,{variant:"subtitle2",color:"error",paragraph:!0,children:c.password.message}),Object(f.jsx)(b.a,{type:"submit",size:"large",fullWidth:!0,variant:"contained",color:"primary",children:"\u0412\u043e\u0439\u0442\u0438"})]})})),g=n(66),m=function(e){var t=e.component,n=Object(g.a)(e,["component"]);return Object(f.jsx)(u.b,{children:function(){return n.loggedIn?Object(f.jsx)(t,Object(l.a)({},n)):Object(f.jsx)(u.a,{to:"./sign-in"})}})},p=n(15);function x(e){var t=e.item;return Object(f.jsxs)("li",{children:[Object(f.jsx)("span",{children:t.id}),Object(f.jsx)("span",{children:t.username}),Object(f.jsx)("span",{children:t.last_login})]})}var v=n(64),w=n.n(v),S=n(65),k=n.n(S);function L(e){var t=e.setLoggedIn,n=Object(r.useState)([{}]),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(null),u=Object(s.a)(i,2),l=u[0],j=u[1],d=Object(r.useState)([{}]),h=Object(s.a)(d,2),O=h[0],g=h[1],m=function(){var e;(e=localStorage.jwt,fetch("https://agile-garden-50413.herokuapp.com/api/users",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))).then((function(e){g(e),o(e)})).catch((function(e){return console.log(e)}))};Object(r.useEffect)((function(){m()}),[]);return Object(r.useEffect)((function(){return o(l?function(e){return c.filter((function(t){return t.username.toLowerCase().indexOf(e.toLowerCase())>-1}))}(l):O)}),[l]),Object(f.jsxs)("main",{className:"content",children:[Object(f.jsx)("input",{type:"text",placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043b\u043e\u0433\u0438\u043d\u0443",value:l||"",onChange:function(e){return j(e.target.value)}}),Object(f.jsxs)("ul",{children:[Object(f.jsxs)("li",{children:[Object(f.jsxs)("span",{className:"content__list",children:["ID ",Object(f.jsx)(w.a,{onClick:function(){var e=Object(p.a)(c).sort((function(e,t){return t.id-e.id}));o(e)}}),Object(f.jsx)(k.a,{onClick:function(){var e=Object(p.a)(c).sort((function(e,t){return e.id-t.id}));o(e)}})]}),Object(f.jsx)("span",{className:"content__list",children:"Username"}),Object(f.jsx)("span",{className:"content__list",children:"Last login"})]}),c.map((function(e,t){return Object(f.jsx)(x,{item:e},t)}))]}),Object(f.jsx)(b.a,{size:"large",fullWidth:!0,variant:"contained",color:"primary",onClick:function(){localStorage.removeItem("jwt"),t(!1)},children:"\u0412\u044b\u0439\u0442\u0438"})]})}function y(){var e=Object(r.useState)(!1),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(u.g)();return Object(r.useEffect)((function(){localStorage.getItem("jwt")&&(a(!0),c.push("/"))}),[c]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(i.a,{}),Object(f.jsxs)(u.d,{children:[Object(f.jsx)(m,{exact:!0,path:"/",loggedIn:n,setLoggedIn:a,component:L}),Object(f.jsx)(u.b,{path:"/sign-in",children:Object(f.jsx)(O,{handleLogin:function(){a(!0)}})})]})]})}var C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,121)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))},I=n(43);o.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(I.a,{children:Object(f.jsx)(y,{})})}),document.getElementById("root")),C()}},[[85,1,2]]]);
//# sourceMappingURL=main.56e30d3b.chunk.js.map