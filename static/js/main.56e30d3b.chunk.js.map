{"version":3,"sources":["Login.js","Api.js","ProtectedRoute.js","User.js","Users.js","App.js","reportWebVitals.js","index.js"],"names":["withRouter","handleLogin","history","useForm","handleSubmit","errors","formState","control","onSubmit","data","username","password","fetch","method","headers","body","JSON","stringify","then","res","ok","json","Promise","reject","status","auth_token","localStorage","setItem","catch","err","console","log","authorize","push","noValidate","Typography","variant","name","defaultValue","rules","required","value","message","minLength","maxLength","render","field","TextField","type","label","fullWidth","margin","color","paragraph","Button","size","ProtectRoute","Component","component","props","loggedIn","to","User","item","id","last_login","Users","setLoggedIn","useState","users","setUsers","search","setSearch","initialList","setInitialList","listUsers","jwt","Authorization","useEffect","filter","el","toLowerCase","indexOf","filterino","className","placeholder","onChange","e","target","onClick","sort","a","b","map","index","removeItem","App","useHistory","getItem","CssBaseline","exact","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"gPA6EeA,mBAxEf,YAA0C,IAAzBC,EAAwB,EAAxBA,YAAaC,EAAW,EAAXA,QAAW,EACkBC,cAAjDC,EAD+B,EAC/BA,aAA2BC,EADI,EACjBC,UAAaD,OAAUE,EADN,EACMA,QAa7C,OACI,uBAAMC,SAAUJ,GAbH,SAAAK,GAEf,OCTqB,SAACC,EAAUC,GAClC,OAAOC,MAAM,2DAA4D,CACvEC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CAACP,WAAUC,eAEjCO,MAAK,SAAAC,GAAG,OAAIA,EAAIC,GAAKD,EAAIE,OAASC,QAAQC,OAAR,gDAA0BJ,EAAIK,YAChEN,MAAK,SAAAT,GACJ,OAAIA,EAAKgB,YACPC,aAAaC,QAAQ,MAAOlB,EAAKgB,YAC1BhB,QAEP,KAGHmB,OAAM,SAAAC,GAAG,OAAIC,QAAQC,IAAIF,MDRjBG,CADsBvB,EAAtBC,SAAsBD,EAAZE,UAEdO,MAAK,SAACT,GACDA,EAAKgB,aACPxB,IACAC,EAAQ+B,KAAK,SAGhBL,OAAM,SAACC,GAAD,OAASC,QAAQC,IAAIF,SAIYK,YAAU,EAAlD,UACE,cAACC,EAAA,EAAD,CAAYC,QAAQ,KAApB,4CACA,cAAC,IAAD,CACEC,KAAK,WACL9B,QAASA,EACT+B,aAAa,GACbC,MAAO,CACLC,SAAU,CACRC,OAAO,EACPC,QAAS,qGAEXC,UAAW,CACTF,MAAO,EACPC,QAAS,2FAEXE,UAAW,CACTH,MAAO,GACPC,QAAS,6FAGbG,OAAQ,YAAgB,IAAbC,EAAY,EAAZA,MACT,OAAO,cAACC,EAAA,EAAD,aAAWC,KAAK,OAAOC,MAAM,WAAWb,QAAQ,WAAWI,UAAQ,EAACU,WAAS,EAACC,OAAO,UAAaL,OAE5GzC,EAAOK,UAAY,cAACyB,EAAA,EAAD,CAAYC,QAAQ,YAAYgB,MAAM,QAAQC,WAAW,EAAzD,SAAgEhD,EAAOK,SAASgC,UACpG,cAAC,IAAD,CACEL,KAAK,WACL9B,QAASA,EACT+B,aAAa,GACbC,MAAO,CACLC,SAAU,CACRC,OAAO,EACPC,QAAS,qGAEXC,UAAW,CACTF,MAAO,EACPC,QAAS,2FAEXE,UAAW,CACTH,MAAO,GACPC,QAAS,6FAGbG,OAAQ,YAAgB,IAAbC,EAAY,EAAZA,MACT,OAAO,cAACC,EAAA,EAAD,aAAWC,KAAK,WAAWC,MAAM,WAAWb,QAAQ,WAAWI,UAAQ,EAACU,WAAS,EAACC,OAAO,UAAaL,OAEhHzC,EAAOM,UAAY,cAACwB,EAAA,EAAD,CAAYC,QAAQ,YAAYgB,MAAM,QAAQC,WAAW,EAAzD,SAAgEhD,EAAOM,SAAS+B,UACpG,cAACY,EAAA,EAAD,CACEN,KAAK,SACLO,KAAK,QACLL,WAAS,EACTd,QAAQ,YACRgB,MAAM,UALR,kD,QEvDOI,EARM,SAAC,GAAwC,IAA3BC,EAA0B,EAArCC,UAAyBC,EAAY,6BAC3D,OACE,cAAC,IAAD,UACG,kBAAMA,EAAMC,SAAW,cAACH,EAAD,eAAeE,IAAY,cAAC,IAAD,CAAUE,GAAG,kB,QCNvD,SAASC,EAAT,GAAyB,IAATC,EAAQ,EAARA,KAC7B,OACE,+BACE,+BAAOA,EAAKC,KACZ,+BAAOD,EAAKrD,WACZ,+BAAOqD,EAAKE,gB,sCCEH,SAASC,EAAT,GAAiC,IAAhBC,EAAe,EAAfA,YAAe,EACnBC,mBAAS,CAAC,KADS,mBACtCC,EADsC,KAC/BC,EAD+B,OAEjBF,mBAAS,MAFQ,mBAEtCG,EAFsC,KAE9BC,EAF8B,OAGPJ,mBAAS,CAAC,KAHH,mBAGtCK,EAHsC,KAGzBC,EAHyB,KAUvCC,EAAY,WHGM,IAACC,KGFZlD,aAAakD,IHGnBhE,MAAM,qDAAsD,CACjEC,OAAQ,MACRC,QAAS,CACP,eAAgB,mBAChB+D,cAAc,SAAD,OAAWD,MAGzB1D,MAAK,SAACC,GAAD,OAASA,EAAIE,UAClBH,MAAK,SAACC,GACL,OAAOA,KAERS,OAAM,SAACC,GAAD,OAASC,QAAQC,IAAIF,OGbzBX,MAAK,SAACC,GACLuD,EAAevD,GACfmD,EAASnD,MAEVS,OAAM,SAACC,GAAD,OAASC,QAAQC,IAAIF,OAGhCiD,qBAAU,WACRH,MACC,IA4BH,OARAG,qBAAU,WACR,OAGSR,EAHJC,EAPW,SAACA,GACjB,OAAOF,EAAMU,QAAO,SAAAC,GAClB,OAAOA,EAAGtE,SAASuE,cAAcC,QAAQX,EAAOU,gBAAkB,KAQlDE,CAAUZ,GAFVE,KAIjB,CAACF,IAGF,uBAAMa,UAAU,UAAhB,UACE,uBAAOpC,KAAK,OAAOqC,YAAY,mFAAkB5C,MAAO8B,GAAU,GAAIe,SAlBrD,SAAAC,GAAC,OAAIf,EAAUe,EAAEC,OAAO/C,UAmBzC,+BACE,+BACE,uBAAM2C,UAAU,gBAAhB,gBAAmC,cAAC,IAAD,CAAmBK,QA/B7C,WACf,IAAMC,EAAO,YAAIrB,GAAOqB,MAAK,SAACC,EAAEC,GAAH,OAASA,EAAE5B,GAAK2B,EAAE3B,MAC/CM,EAASoB,MA6BuE,cAAC,IAAD,CAAiBD,QA1BpF,WACb,IAAMC,EAAO,YAAIrB,GAAOqB,MAAK,SAACC,EAAEC,GAAH,OAASD,EAAE3B,GAAK4B,EAAE5B,MAC/CM,EAASoB,SAyBH,sBAAMN,UAAU,gBAAhB,sBACA,sBAAMA,UAAU,gBAAhB,2BAEDf,EAAMwB,KAAI,SAAC9B,EAAM+B,GAAP,OACT,cAAChC,EAAD,CAAMC,KAAMA,GAAW+B,SAG3B,cAACxC,EAAA,EAAD,CAAQC,KAAK,QAAQL,WAAS,EAACd,QAAQ,YAAYgB,MAAM,UAAUqC,QAzDxD,WACb/D,aAAaqE,WAAW,OACxB5B,GAAY,IAuDV,+CC9DS,SAAS6B,IAAO,IAAD,EACI5B,oBAAS,GADb,mBACrBR,EADqB,KACXO,EADW,KAEtBjE,EAAU+F,cAchB,OAZAnB,qBAAU,WACMpD,aAAawE,QAAQ,SAEjC/B,GAAY,GACZjE,EAAQ+B,KAAK,QAEd,CAAC/B,IAOF,qCACE,cAACiG,EAAA,EAAD,IACE,eAAC,IAAD,WACE,cAAC,EAAD,CACEC,OAAK,EAACC,KAAK,IACXzC,SAAUA,EACVO,YAAaA,EACbT,UAAWQ,IAEb,cAAC,IAAD,CAAOmC,KAAK,WAAZ,SACE,cAAC,EAAD,CACEpG,YAhBZ,WACEkE,GAAY,cCpBhB,IAYemC,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqBtF,MAAK,YAAkD,IAA/CuF,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,O,QCAdO,IAASjE,OACP,cAAC,IAAMkE,WAAP,UACE,cAAC,IAAD,UACE,cAACf,EAAD,QAGJgB,SAASC,eAAe,SAG1BX,M","file":"static/js/main.56e30d3b.chunk.js","sourcesContent":["import { withRouter } from \"react-router-dom\";\r\nimport { authorize } from \"./Api\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { Button, Typography, TextField } from \"@material-ui/core\";\r\n\r\nfunction Login({ handleLogin, history }) {\r\n  const { handleSubmit, formState: { errors }, control } = useForm();\r\n  const onSubmit = data => {\r\n    const {username, password} = data;\r\n    return authorize(username, password)\r\n      .then((data) => {\r\n        if (data.auth_token) {\r\n          handleLogin();\r\n          history.push(\"/\");\r\n        }\r\n      })\r\n      .catch((err) => console.log(err));\r\n  };\r\n\r\n  return (\r\n      <form onSubmit={handleSubmit(onSubmit)} noValidate>\r\n        <Typography variant=\"h4\">Войти</Typography>\r\n        <Controller\r\n          name=\"username\"\r\n          control={control}\r\n          defaultValue=''\r\n          rules={{ \r\n            required: {\r\n              value: true,\r\n              message: 'Обязательное поле'\r\n            },\r\n            minLength: {\r\n              value: 2,\r\n              message: 'Меньше 2 символов'\r\n            },\r\n            maxLength: {\r\n              value: 15,\r\n              message: 'Больше 15 символов'\r\n            } \r\n          }}\r\n          render={({ field }) => {\r\n            return <TextField type=\"text\" label=\"Username\" variant=\"outlined\" required fullWidth margin=\"normal\" {...field}/>}}\r\n        />\r\n        {errors.username && <Typography variant=\"subtitle2\" color=\"error\" paragraph={true}>{errors.username.message}</Typography>}\r\n        <Controller\r\n          name=\"password\"\r\n          control={control}\r\n          defaultValue=''\r\n          rules={{ \r\n            required: {\r\n              value: true,\r\n              message: 'Обязательное поле'\r\n            },\r\n            minLength: {\r\n              value: 2,\r\n              message: 'Меньше 2 символов'\r\n            },\r\n            maxLength: {\r\n              value: 15,\r\n              message: 'Больше 15 символов'\r\n            } \r\n          }}\r\n          render={({ field }) => {\r\n            return <TextField type=\"password\" label=\"Password\" variant=\"outlined\" required fullWidth margin=\"normal\" {...field} />}}\r\n        />\r\n        {errors.password && <Typography variant=\"subtitle2\" color=\"error\" paragraph={true}>{errors.password.message}</Typography>}\r\n        <Button \r\n          type=\"submit\" \r\n          size=\"large\"\r\n          fullWidth\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n        >Войти</Button>\r\n      </form>\r\n  );\r\n}\r\n\r\nexport default withRouter(Login);","export const authorize = (username, password) => {\r\n  return fetch(`https://agile-garden-50413.herokuapp.com/api/token/login`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({username, password})\r\n  })\r\n  .then(res => res.ok ? res.json() : Promise.reject(`Ошибка: ${res.status}`))\r\n  .then(data => {\r\n    if (data.auth_token) {\r\n      localStorage.setItem('jwt', data.auth_token);\r\n      return data;\r\n    } else {\r\n      return\r\n    }\r\n  })\r\n  .catch(err => console.log(err));\r\n}\r\n\r\nexport const getContent = (jwt) => {\r\n  return fetch(`https://agile-garden-50413.herokuapp.com/api/users`, {\r\n    method: \"GET\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Token ${jwt}`\r\n    }\r\n  })\r\n    .then((res) => res.json())\r\n    .then((res) => {\r\n      return res;\r\n    })\r\n    .catch((err) => console.log(err));\r\n};","import React from \"react\";\r\nimport { Redirect, Route } from \"react-router-dom\";\r\n\r\nconst ProtectRoute = ({ component: Component, ...props }) => {\r\n  return (\r\n    <Route>\r\n      {() => props.loggedIn ? <Component {...props} /> : <Redirect to='./sign-in' />}\r\n    </Route>\r\n  )\r\n}\r\n\r\nexport default ProtectRoute;","export default function User({ item }) {\r\n  return (\r\n    <li>\r\n      <span>{item.id}</span>\r\n      <span>{item.username}</span>\r\n      <span>{item.last_login}</span>\r\n    </li>\r\n  );\r\n}","import { Button } from \"@material-ui/core\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { getContent } from \"./Api\";\r\nimport User from \"./User\";\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\r\n\r\nexport default function Users({ setLoggedIn }) {\r\n  const [users, setUsers] = useState([{}]);\r\n  const [search, setSearch] = useState(null);\r\n  const [initialList, setInitialList] = useState([{}]);\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem(\"jwt\");\r\n    setLoggedIn(false);\r\n  }\r\n\r\n  const listUsers = () => {\r\n    getContent(localStorage.jwt)\r\n      .then((res) => {\r\n        setInitialList(res)\r\n        setUsers(res)\r\n      })\r\n      .catch((err) => console.log(err));\r\n  }\r\n  \r\n  useEffect(() => {\r\n    listUsers();\r\n  }, []);\r\n\r\n  const sortDown = () => {\r\n    const sort = [...users].sort((a,b) => b.id - a.id)\r\n    setUsers(sort);\r\n  }\r\n\r\n  const sortUp = () => {\r\n    const sort = [...users].sort((a,b) => a.id - b.id)\r\n    setUsers(sort);\r\n  }\r\n\r\n  const handleChange = e => setSearch(e.target.value);\r\n\r\n  const filterino = (search) => {\r\n    return users.filter(el => {\r\n      return el.username.toLowerCase().indexOf(search.toLowerCase()) > -1;\r\n    });\r\n  }\r\n  \r\n  useEffect(() => {\r\n    if (!search) {\r\n      return setUsers(initialList)\r\n    } else {\r\n      return setUsers(filterino(search));\r\n    }\r\n  }, [search]);\r\n  \r\n  return (\r\n    <main className=\"content\">\r\n      <input type=\"text\" placeholder=\"Поиск по логину\" value={search || ''} onChange={handleChange}/>\r\n      <ul>\r\n        <li>\r\n          <span className=\"content__list\">ID <ArrowDropDownIcon onClick={sortDown}/><ArrowDropUpIcon onClick={sortUp}/></span>\r\n          <span className=\"content__list\">Username</span>\r\n          <span className=\"content__list\">Last login</span>\r\n        </li>\r\n        {users.map((item, index) => (\r\n          <User item={item} key={index} />\r\n        ))}\r\n      </ul>\r\n      <Button size=\"large\" fullWidth variant=\"contained\" color=\"primary\" onClick={logout}>Выйти</Button>\r\n    </main>\r\n  );\r\n}","import { CssBaseline } from \"@material-ui/core\";\nimport { useEffect, useState } from \"react\";\nimport { Route, Switch, useHistory } from \"react-router\";\nimport Login from \"./Login\";\nimport ProtectRoute from \"./ProtectedRoute\";\nimport Users from \"./Users\";\n\nexport default function App() {\n  const [loggedIn, setLoggedIn] = useState(false);\n  const history = useHistory();\n\n  useEffect(() => {\n    const token = localStorage.getItem('jwt');\n    if (token) {\n      setLoggedIn(true);\n      history.push('/');\n    }\n  }, [history]);\n\n  function handleLogin() {\n    setLoggedIn(true);\n  }\n\n  return (\n    <>\n      <CssBaseline />\n        <Switch>\n          <ProtectRoute \n            exact path='/' \n            loggedIn={loggedIn} \n            setLoggedIn={setLoggedIn} \n            component={Users} \n          />\n          <Route path='/sign-in'>\n            <Login \n              handleLogin={handleLogin}\n            />\n          </Route>\n        </Switch>\n    </>\n  );\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { HashRouter } from 'react-router-dom';\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n      <App />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nreportWebVitals();\n"],"sourceRoot":""}